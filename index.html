<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kerem Şükrü Keskin | Başlangıç Sayfası</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* General Resets and Basic Styles */
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center; /* Center content vertically */
            align-items: center; /* Center content horizontally */
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* Prevent blob overflow */
            position: relative; /* For blobs */
            transition: background-color 0.5s ease; /* For theme transition */
            color: #333; /* Default text color for light theme */
        }

        /* Theme-Based Background Colors */
        body.light-theme {
            background-color: #ffffff;
            color: #333;
        }

        body.dark-theme {
            background-color: #1a1a1a;
            color: #f0f0f0;
        }

        /* Blurry Lights (Blobs) */
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px); /* Blur effect */
            opacity: 0.6;
            animation: blob-move 20s infinite alternate ease-in-out;
            z-index: -1; /* To stay behind content */
        }

        /* Light Theme Blob Colors */
        body.light-theme .blob {
            background-color: rgba(173, 216, 230, 0.7); /* Light blue */
        }

        /* Dark Theme Blob Colors */
        body.dark-theme .blob {
            background-color: rgba(65, 105, 225, 0.7); /* Dark blue */
        }

        /* Blob Sizes and Positions */
        .blob:nth-child(1) {
            width: 300px;
            height: 300px;
            top: 10%;
            left: 15%;
            animation-delay: 0s;
        }

        .blob:nth-child(2) {
            width: 400px;
            height: 400px;
            bottom: 20%;
            right: 10%;
            animation-delay: 5s;
        }

        .blob:nth-child(3) {
            width: 250px;
            height: 250px;
            top: 30%;
            right: 20%;
            animation-delay: 10s;
        }

        .blob:nth-child(4) {
            width: 350px;
            height: 350px;
            bottom: 5%;
            left: 30%;
            animation-delay: 15s;
        }

        /* Blob Animation */
        @keyframes blob-move {
            0% {
                transform: translate(0, 0) scale(1);
            }
            25% {
                transform: translate(20px, -30px) scale(1.1);
            }
            50% {
                transform: translate(-10px, 40px) scale(0.9);
            }
            75% {
                transform: translate(30px, 10px) scale(1.05);
            }
            100% {
                transform: translate(0, 0) scale(1);
            }
        }

        /* Main Content Container */
        .main-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1; /* To stay above blobs */
            width: 100%;
            max-width: 900px;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Title */
        .title {
            text-align: center;
            font-size: 2.5em;
            font-weight: 700;
            color: inherit; /* Inherit theme color */
            transition: color 0.5s ease;
            z-index: 2; /* To stay above other elements */
            margin-bottom: 40px; /* Space from search box */
        }

        /* Weather Widget */
        .weather-widget {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: rgba(255, 255, 255, 0.1); /* Slightly transparent background */
            backdrop-filter: blur(10px); /* Blur background */
            border-radius: 12px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: inherit; /* Inherit theme color */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        body.dark-theme .weather-widget {
            background-color: rgba(0, 0, 0, 0.2);
        }

        .weather-icon {
            font-size: 2.5em; /* Font Awesome icon size */
            color: inherit; /* Get color based on theme */
            display: block; /* Show icon again */
            width: 50px; /* To be same size as box */
            text-align: center; /* Center icon */
        }

        .weather-info {
            display: flex;
            flex-direction: column;
            font-size: 0.9em;
        }

        .weather-info .temp {
            font-size: 1.5em;
            font-weight: 600;
        }

        /* Same font size for humidity and location */
        .weather-info .info-text {
            font-size: 0.9em;
            margin-top: 2px; /* Small space between elements */
        }

        /* Clock Widget */
        .clock-widget {
            position: absolute;
            top: 20px;
            right: 20px; /* Align right */
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 15px 20px;
            display: flex;
            flex-direction: column; /* Vertical arrangement */
            align-items: flex-end; /* Align content to the right */
            gap: 5px; /* Space between elements */
            color: inherit;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        body.dark-theme .clock-widget {
            background-color: rgba(0, 0, 0, 0.2);
        }

        .clock-widget .time-display {
            font-size: 1.8em; /* Main clock size */
            font-weight: 600;
            display: flex;
            gap: 2px; /* Space between hour, minute, second */
            font-variant-numeric: tabular-nums; /* Ensures numbers have fixed width */
            text-align: right; /* Align clock to the right */
        }

        .clock-widget .date-display {
            font-size: 0.9em; /* Date info size */
            text-align: right; /* Align date to the right */
        }

        /* Search Bar */
        .search-form {
            display: flex;
            width: 100%;
            max-width: 600px; /* Chrome-like size */
            background-color: rgba(255, 255, 255, 0.15); /* Slightly transparent */
            backdrop-filter: blur(10px);
            border-radius: 30px; /* Rounded corners */
            padding: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: background-color 0.5s ease, box-shadow 0.3s ease;
        }

        body.dark-theme .search-form {
            background-color: rgba(0, 0, 0, 0.3);
        }

        .search-form:focus-within {
            box-shadow: 0 4px 25px rgba(0, 0, 0, 0.2);
        }

        .search-input {
            flex-grow: 1;
            border: none;
            outline: none;
            background: transparent;
            padding: 10px 20px;
            font-size: 1.1em;
            color: inherit; /* Inherit theme color */
        }

        /* Make autofill background and text color transparent */
        .search-input:-webkit-autofill,
        .search-input:-webkit-autofill:hover,
        .search-input:-webkit-autofill:focus,
        .search-input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0px 1000px transparent inset !important;
            background-color: transparent !important;
            color: inherit !important; /* Preserve text color based on theme */
            -webkit-text-fill-color: inherit !important; /* Preserve text color for Webkit browsers */
            font-size: inherit !important; /* Preserve font size */
            transition: background-color 5000s ease-in-out 0s; /* Slow transition to make it invisible */
        }


        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7); /* More visible in dark theme */
        }

        body.light-theme .search-input::placeholder {
            color: rgba(51, 51, 51, 0.6);
        }

        .search-button {
            background-color: #4285f4; /* Google blue */
            color: white;
            border: none;
            border-radius: 25px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }

        .search-button:hover {
            background-color: #357ae8;
        }

        /* Quick Access Links */
        .quick-links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px; /* Reduced gap */
            margin-top: 25px; /* Reduced distance from search box */
            width: 100%;
            max-width: 600px;
        }

        .quick-link-item {
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            border-radius: 50%; /* Make it round */
            width: 50px; /* Fixed width, reduced */
            height: 50px; /* Fixed height, reduced */
            display: flex; /* Use flexbox to center content */
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
            text-decoration: none;
            color: inherit;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        body.dark-theme .quick-link-item {
            background-color: rgba(0, 0, 0, 0.2);
        }

        .quick-link-item:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }

        body.dark-theme .quick-link-item:hover {
            background-color: rgba(0, 0, 0, 0.4);
        }

        /* Style for SVG icons */
        .quick-link-item .icon {
            width: 60%; /* Adjust SVG icon size relative to container */
            height: 60%;
            color: inherit; /* Get color based on theme */
        }

        /* Style for Font Awesome icons */
        .quick-link-item i.fas {
            font-size: 26px; /* More balanced size for Font Awesome icons */
            color: inherit; /* Get color based on theme */
        }

        /* Error Message */
        .error-message {
            color: #e74c3c;
            margin-top: 15px;
            font-weight: 600;
            text-align: center;
            display: none; /* Hidden by default */
        }

        /* Responsive Settings */
        @media (max-width: 768px) {
            body {
                padding-top: 0;
            }
            .title {
                font-size: 1.8em;
                margin-bottom: 30px;
            }

            .weather-widget {
                top: 10px;
                left: 10px;
                padding: 10px 15px;
                font-size: 0.8em;
            }
            .weather-info .temp {
                font-size: 1.2em;
            }
            .weather-icon {
                font-size: 2em;
            }

            .clock-widget {
                top: 10px;
                right: 10px;
                padding: 10px 15px;
            }
            .clock-widget .time-display {
                font-size: 1.5em;
            }
            .clock-widget .date-display {
                font-size: 0.8em;
            }

            .search-form {
                max-width: 90%;
                padding: 6px;
            }
            .search-input {
                    font-size: 1em;
                    padding: 8px 15px;
            }
            .search-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }

            .quick-links {
                gap: 10px;
                margin-top: 20px;
            }
            .quick-link-item {
                width: 45px;
                height: 45px;
            }
            /* Adjust icon size for responsiveness */
            .quick-link-item .icon {
                width: 65%; /* Responsive size for SVG icons */
                height: 65%;
            }
            .quick-link-item i.fas {
                font-size: 24px; /* Responsive size for Font Awesome icons */
            }
        }

        @media (max-width: 480px) {
            body {
                padding-top: 0;
            }
            .title {
                font-size: 1.5em;
                margin-bottom: 20px;
            }
            .weather-widget {
                font-size: 0.7em;
                padding: 8px 12px;
            }
            .weather-icon {
                font-size: 1.8em;
            }

            .clock-widget {
                top: 10px;
                right: 10px;
                padding: 8px 12px;
            }
            .clock-widget .time-display {
                font-size: 1.3em;
            }
            .clock-widget .date-display {
                font-size: 0.7em;
            }

            .search-form {
                flex-direction: column;
                border-radius: 15px;
                padding: 0;
            }
            .search-input {
                width: calc(100% - 30px);
                border-bottom: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 15px 15px 0 0;
                padding: 15px;
                text-align: center;
            }
            body.light-theme .search-input {
                border-bottom: 1px solid rgba(51, 51, 51, 0.2);
            }
            .search-button {
                width: 100%;
                border-radius: 0 0 15px 15px;
                padding: 15px;
            }
            .quick-links {
                flex-direction: row;
                flex-wrap: wrap;
                align-items: center;
                gap: 8px;
                margin-top: 15px;
            }
            .quick-link-item {
                width: 40px;
                height: 40px;
            }
            /* Adjust icon size for responsiveness */
            .quick-link-item .icon {
                width: 60%; /* Responsive size for SVG icons */
                height: 60%;
            }
            .quick-link-item i.fas {
                font-size: 20px; /* Responsive size for Font Awesome icons */
            }
        }
    </style>
</head>
<body class="light-theme">
    <div class="blob"></div>
    <div class="blob"></div>
    <div class="blob"></div>
    <div class="blob"></div>

    <div class="main-content">
        <h1 class="title">Kerem Şükrü Keskin</h1>

        <form action="https://www.google.com/search" method="get" class="search-form" id="searchForm">
            <input type="text" name="q" id="searchInput" class="search-input" placeholder="Google'da Ara..." autofocus>
            <button type="submit" class="search-button">Ara</button>
        </form>

        <div class="quick-links">
            <!-- Gmail simgesi -->
            <a href="https://mail.google.com/" class="quick-link-item">
                <i class="fas fa-envelope"></i>
            </a>
            <!-- irmsyeo -->
            <a href="https://www.instagram.com/irmsyeo/" class="quick-link-item">
                <i class="fas fa-moon"></i>
            </a>
            <!-- Google Maps simgesi -->
            <a href="https://maps.google.com/" class="quick-link-item">
                <i class="fas fa-location-dot"></i>
            </a>
            <!-- YouTube simgesi -->
            <a href="https://youtube.com" class="quick-link-item">
                <svg viewBox="0 0 24 24" fill="currentColor" class="icon">
                    <path d="M21.54 6.54a3.1 3.1 0 0 0-2.19-2.19C17.82 4 12 4 12 4s-5.82 0-7.35.35a3.1 3.1 0 0 0-2.19 2.19C2 8.18 2 12 2 12s0 3.82.35 5.35a3.1 3.1 0 0 0 2.19 2.19C6.18 20 12 20 12 20s5.82 0 7.35-.35a3.1 3.1 0 0 0 2.19-2.19C22 15.82 22 12 22 12s0-3.82-.35-5.35zM10 15.5v-7l6 3.5-6 3.5z"/>
                </svg>
            </a>
            <a href="https://chat.openai.com/" class="quick-link-item">
                <svg viewBox="0 0 24 24" fill="currentColor" class="icon">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.5 13.5h-7V8.5h7v7zM10 10.5v3h4v-3h-4z"/>
                </svg>
            </a>
            <!-- Gemini simgesi -->
            <a href="https://gemini.google.com/" class="quick-link-item">
                <!-- Abstract Gemini-like icon: Two slightly overlapping squares -->
                <svg viewBox="0 0 24 24" fill="currentColor" class="icon">
                    <rect x="3" y="3" width="12" height="12" rx="2" ry="2"/>
                    <rect x="9" y="9" width="12" height="12" rx="2" ry="2"/>
                </svg>
            </a>
        </div>
    </div>

    <div class="weather-widget">
        <i id="weatherIcon" class="weather-icon fas"></i>
        <div class="weather-info">
            <span id="weatherTemp" class="temp"></span>
            <span id="weatherHumidity" class="info-text"></span>
            <span id="weatherCity" class="info-text"></span>
        </div>
    </div>

    <div class="clock-widget">
        <div class="time-display">
            <span id="clockHour" class="time-part hour"></span>:<span id="clockMinute" class="time-part minute"></span>:<span id="clockSecond" class="time-part second"></span>
        </div>
        <div class="date-display">
            <span id="clockDay" class="date-part day"></span> <span id="clockMonth" class="date-part month"></span> <span id="clockYear" class="date-part year"></span> <span id="clockDayOfWeek" class="date-part day-of-week"></span>
        </div>
    </div>

    <p id="errorMessage" class="error-message"></p>

    <script>
        // Your Visual Crossing API Key
        const VISUALCROSSING_API_KEY = 'N7JPMD9V7XRM6PQY7R7TJWZTS';
        const VISUALCROSSING_BASE_URL = 'https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/';

        // Nominatim Reverse Geocoding API URL
        // In accordance with Nominatim's usage policy, please specify your own email address in the 'user-agent' parameter.
        // Example: 'https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=14&addressdetails=1&accept-language=tr&user-agent=your-email@example.com'
        const NOMINATIM_BASE_URL = 'https://nominatim.openstreetmap.org/reverse';

        const weatherIconElem = document.getElementById('weatherIcon');
        const weatherTempElem = document.getElementById('weatherTemp');
        const weatherHumidityElem = document.getElementById('weatherHumidity');
        const weatherCityElem = document.getElementById('weatherCity');
        const errorMessageElem = document.getElementById('errorMessage');
        const searchInput = document.getElementById('searchInput');
        const searchForm = document.getElementById('searchForm'); // Select the search form

        // Clock elements
        const clockHourElem = document.getElementById('clockHour');
        const clockMinuteElem = document.getElementById('clockMinute');
        const clockSecondElem = document.getElementById('clockSecond');
        const clockDayOfWeekElem = document.getElementById('clockDayOfWeek');
        const clockDayElem = document.getElementById('clockDay');
        const clockMonthElem = document.getElementById('clockMonth');
        const clockYearElem = document.getElementById('clockYear');

        // Theme Detection and Application
        function applyTheme(isDark) {
            const body = document.body;
            if (isDark) {
                body.classList.remove('light-theme');
                body.classList.add('dark-theme');
            } else {
                body.classList.remove('dark-theme');
                body.classList.add('light-theme');
            }
        }

        // Check device's theme preference
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
        applyTheme(prefersDarkScheme.matches);

        // Update when theme preference changes
        prefersDarkScheme.addEventListener('change', (e) => {
            applyTheme(e.matches);
        });

        // Map Visual Crossing icon names to Font Awesome classes
        function getFontAwesomeIconClass(vcIconName) {
            switch (vcIconName) {
                case 'clear-day':
                    return 'fa-sun';
                case 'clear-night':
                    return 'fa-moon';
                case 'partly-cloudy-day':
                    return 'fa-cloud-sun';
                case 'partly-cloudy-night':
                    return 'fa-cloud-moon';
                case 'cloudy':
                    return 'fa-cloud';
                case 'rain':
                    return 'fa-cloud-showers-heavy';
                case 'showers-day':
                case 'showers-night':
                    return 'fa-cloud-rain';
                case 'thunder-rain':
                case 'thunder-showers-day':
                case 'thunder-showers-night':
                case 'thunder':
                    return 'fa-bolt';
                case 'snow':
                case 'snow-showers-day':
                case 'snow-showers-night':
                    return 'fa-snowflake';
                case 'fog':
                    return 'fa-smog';
                case 'wind':
                    return 'fa-wind';
                case 'sleet':
                    return 'fa-cloud-meatball'; // For mixed precipitation
                case 'hail':
                    return 'fa-cloud-showers-heavy'; // Similar icon for hail
                default:
                    return 'fa-question-circle'; // For unknown icons
            }
        }

        // Fetch Weather Data
        // locationForWeatherFetch: Location to send to weather API (coordinates or city name)
        // actualProvinceNameForDisplay: Province name to display in the widget
        async function getWeatherData(locationForWeatherFetch, actualProvinceNameForDisplay) {
            errorMessageElem.textContent = ''; // Clear previous errors
            errorMessageElem.style.display = 'none'; // Hide error message initially

            // Create URL for Visual Crossing API request
            const url = `${VISUALCROSSING_BASE_URL}${locationForWeatherFetch}?key=${VISUALCROSSING_API_KEY}&unitGroup=metric&include=current&lang=tr`;

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.message || 'Weather information could not be retrieved.');
                }
                const data = await response.json();
                console.log('Visual Crossing API Response:', data); // Log API response to console
                displayWeatherData(data, actualProvinceNameForDisplay); // Pass province name from Nominatim
            } catch (error) {
                errorMessageElem.textContent = `Hava durumu hatası: ${error.message}`;
                errorMessageElem.style.display = 'block'; // Show on error
                console.error('Error fetching weather data:', error);
            }
        }

        // Display Weather Data on Screen
        function displayWeatherData(data, actualProvinceNameForDisplay) {
            // Hide all weather info elements by default
            weatherTempElem.style.display = 'none';
            weatherHumidityElem.style.display = 'none';
            weatherCityElem.style.display = 'none';
            weatherIconElem.style.display = 'none';
            errorMessageElem.textContent = ''; // Clear previous error messages
            errorMessageElem.style.display = 'none'; // Hide error message on success

            if (data.currentConditions) {
                const current = data.currentConditions;
                weatherTempElem.textContent = `${Math.round(current.temp)}°C`;
                weatherHumidityElem.textContent = `Nem: ${Math.round(current.humidity)}%`;

                // Location name to display in the widget: Province name from Nominatim is prioritized
                if (actualProvinceNameForDisplay) {
                    weatherCityElem.textContent = actualProvinceNameForDisplay;
                } else if (data.resolvedAddress) {
                    // If no province name from Nominatim, use the first part of Visual Crossing's resolvedAddress
                    weatherCityElem.textContent = data.resolvedAddress.split(',')[0].trim();
                } else {
                    weatherCityElem.textContent = 'Bilinmeyen Konum';
                }

                // Make elements visible
                weatherTempElem.style.display = 'block';
                weatherHumidityElem.style.display = 'block';
                weatherCityElem.style.display = 'block';

                // Set Font Awesome icon class
                const iconClass = getFontAwesomeIconClass(current.icon);
                weatherIconElem.className = `weather-icon fas ${iconClass}`; // fas: for solid icons
                weatherIconElem.style.display = 'block'; // Make icon visible

            } else {
                weatherTempElem.textContent = 'Bilgi yok'; // Show "No info" if no data
                // No need to set textContent for other elements, as they will be hidden
                errorMessageElem.textContent = 'Hava durumu verisi bulunamadı. Lütfen API limitlerinizi veya konumunuzu kontrol edin.';
                errorMessageElem.style.display = 'block'; // Show on error
                console.error('No data found or empty in Visual Crossing API response:', data);
            }
        }

        // Function to Update Clock
        function updateClock() {
            const now = new Date();

            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');

            const daysOfWeek = ['Pazar', 'Pazartesi', 'Salı', 'Çarşamba', 'Perşembe', 'Cuma', 'Cumartesi'];
            const months = ['Ocak', 'Şubat', 'Mart', 'Nisan', 'Mayıs', 'Haziran', 'Temmuz', 'Ağustos', 'Eylül', 'Ekim', 'Kasım', 'Aralık'];

            const dayOfWeek = daysOfWeek[now.getDay()];
            const day = now.getDate();
            const month = months[now.getMonth()];
            const year = now.getFullYear();

            clockHourElem.textContent = hours;
            clockMinuteElem.textContent = minutes;
            clockSecondElem.textContent = seconds;

            // Change date order: Day Month Year Day of Week (comma removed)
            clockDayElem.textContent = day;
            clockMonthElem.textContent = month;
            clockYearElem.textContent = year;
            clockDayOfWeekElem.textContent = dayOfWeek;
        }

        // Get province name from coordinates (using Nominatim)
        async function getProvinceNameFromCoordinates(lat, lon) {
            // Create URL for Nominatim API request
            // format=json: Get response in JSON format
            // lat, lon: Latitude and longitude
            // zoom=10: More appropriate zoom level for province level
            // addressdetails=1: Get detailed address components
            // accept-language=tr: Prefer Turkish results
            // user-agent: It is important to specify a user-agent as per Nominatim's usage policy.
            const nominatimUrl = `${NOMINATIM_BASE_URL}?format=json&lat=${lat}&lon=${lon}&zoom=10&addressdetails=1&accept-language=tr&user-agent=my-personal-homepage-app`;

            try {
                const response = await fetch(nominatimUrl);
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Geocoding information could not be retrieved.');
                }
                const data = await response.json();
                console.log('Nominatim API Response:', data);

                if (data.address) {
                    const address = data.address;
                    
                    // Prioritize searching for province name
                    if (address.state) return address.state; // Key used for province in Turkey
                    if (address.province) return address.province; // Equivalent to state/province in some countries

                    // If state/province not found, check city (for metropolitan cities, it's the same as province name)
                    if (address.city) return address.city;

                    // As a last resort, return the first part of display_name
                    if (data.display_name) return data.display_name.split(',')[0].trim();
                }
                return null; // No suitable address component found
            } catch (error) {
                errorMessageElem.textContent = `Konum adı hatası: ${error.message}`;
                errorMessageElem.style.display = 'block';
                console.error('Error fetching geocoding data:', error);
                return null;
            }
        }

        // Get user's location and display weather
        async function getUserLocationWeather() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        // Location to send to weather API will always be coordinates
                        const locationForWeatherFetch = `${lat},${lon}`; 
                        
                        // Fetch province name to display in the widget from Nominatim
                        const provinceNameForDisplay = await getProvinceNameFromCoordinates(lat, lon); 

                        // Fetch weather data based on coordinates, but pass the province name to display in the widget
                        getWeatherData(locationForWeatherFetch, provinceNameForDisplay);
                    },
                    (error) => {
                        console.warn('Location could not be retrieved, switching to default city:', error);
                        // If location permission is not granted or an error occurs, use default city (Kocaeli)
                        getWeatherData('Kocaeli', 'Kocaeli'); // Both location to fetch and display will be Kocaeli
                    },
                    {
                        enableHighAccuracy: true, // Request higher accuracy
                        timeout: 10000, // Increase timeout
                        maximumAge: 0 // Always get new location
                    }
                );
            } else {
                console.warn('Browser does not support location services, switching to default city.');
                getWeatherData('Kocaeli', 'Kocaeli'); // Default city if Geolocation is not supported
            }
        }

        /**
         * Checks if the given text is a simple URL.
         * More comprehensive URL validation may require a more complex regex.
         * @param {string} text Text to check.
         * @returns {boolean} True if the text resembles a URL, otherwise false.
         */
        function isValidUrl(text) {
            // Simple URL check: does it contain http/https, www, or a domain extension like .com, .org?
            const urlRegex = /^(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/[a-zA-Z0-9]+\.[^\s]{2,}|[a-zA-Z0-9]+\.[^\s]{2,})$/i;
            return urlRegex.test(text);
        }

        // Functions to run when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            getUserLocationWeather(); // Get weather data
            updateClock(); // Display clock immediately
            setInterval(updateClock, 1000); // Update clock every second
            searchInput.focus(); // Focus on the search bar

            // Search bar reset function
            searchForm.addEventListener('submit', (event) => {
                // Prevent default form submission
                event.preventDefault();

                const searchQuery = searchInput.value.trim();
                let targetUrl = '';

                if (isValidUrl(searchQuery)) {
                    // If input is a URL
                    if (!searchQuery.startsWith('http://') && !searchQuery.startsWith('https://')) {
                        targetUrl = `https://${searchQuery}`; // Add https for secure connection
                    } else {
                        targetUrl = searchQuery;
                    }
                } else {
                    // If input is not a URL, search on Google
                    targetUrl = `https://www.google.com/search?q=${encodeURIComponent(searchQuery)}`;
                }

                // Clear the search bar
                searchInput.value = '';

                // Open in the current tab/window (default behavior without _blank)
                window.open(targetUrl, '_self'); // Explicitly set to _self for clarity
            });
        });
    </script>
</body>
</html>
